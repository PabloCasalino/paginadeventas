/*
const hogarproductos = [
    {
        id:"fitness-01",
        producto:"ARO DE BASQUET N 7 CON RED Y GANCHOS",
        imagen: "../statics/img/Fitness/ARO DE BASQUET N 7 CON RED Y GANCHOS.jpeg",
        descripcion: "Aro metálico, medida profesional. Su tamaño Nº7 lo hace apto tanto para interiores como exteriores.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 18999

    },

    {
        id:"fitness-02",
        producto:"BANDAS DE RESISTENCIA ANCHAS X2",
        imagen: "../statics/img/Fitness/BANDAS DE RESISTENCIA ANCHAS X2.png",
        descripcion: "Material: Elástico reforzado irrompible.Medidas: 30 cm x 8 cm.kit por 2 bandas anchas (media y alta).",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 6999

    },

   

    {
        id:"fitness-03",
        producto:"BOLSO WILSON FIT",
        imagen: "../statics/img/Fitness/BOLSO WILSON FIT.jpg",
        descripcion: "Medidas: 43.00 cm alto x 34.00 cm ancho x 14.00 cm. Color: Rosa, Lila y Negro.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 21999

    },

    {
        id:"fitness-04",
        producto:"BOTELLA CANTIMPLORA LISA",
        imagen: "../statics/img/Fitness/BOTELLA CANTIMPLORA LISA.jpeg",
        descripcion: "La cantimplora es ideal para senderismo o incluso viajes largos. Su matriz está hecha de plástico PP, para ser ligero y práctico de llevar. Capacidad: 1000 ml.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 2999

    },

    {
        id:"fitness-05",
        producto:"BOTELLA DEPORTIVA",
        imagen: "../statics/img/Fitness/BOTELLA DEPORTIVA.jpeg",
        descripcion: "Botella deportiva de 1 litro, apertura por botón automático con seguro. Material PP, de grado alimenticio, Sin olor. ",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 10999

    },

    {
        id:"fitness-06",
        producto:"BOTELLA EVERLAST",
        imagen: "../statics/img/Fitness/BOTELLA EVERLAST.jpg",
        descripcion: "Correa de transporte, botón de apertura y cierre, tapa interna de silicona. Material: plástico. Capacidad: 600ml. Color: ROSA CELESTE.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 19999

    },

    {
        id:"fitness-07",
        producto:"BRAZALETE PARA CORRER UNIVERSAL",
        imagen: "../statics/img/Fitness/BRAZALETE PARA CORRER UNIVERSAL.jpg",
        descripcion: "Porta celular hasta pantallas de 5.5''. Medida: 16.5x9 cm. Compartimiento de llave. Plástico transparente para uso táctil del celular.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 2999

    },

    {
        id:"fitness-08",
        producto:"COLCHONETA 100X40X4 CM",
        imagen: "../statics/img/Fitness/COLCHONETA-100x40x4cm.jpg",
        descripcion: "Colores: Rojo - Negro - Azul- Fucsia. De alta densidad, 4 cm x 40 cm x 100 cm, recubiertas con tela %100 CORDURA, fácil de limpiar o lavar con cierre reforzado.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 19999

    },

    {
        id:"fitness-09",
        producto:"COLCHONETA PLEGABLE",
        imagen: "../statics/img/Fitness/COLCHONETA PLEGABLE.jpg",
        descripcion: "Alta densidad, excelente calidad, con correa para trasladar. Medidas: 50x1x3cm.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 21999

    },

    {
        id:"fitness-10",
        producto:"CONOS TORTUGA X 10 UNID",
        imagen: "../statics/img/Fitness/CONOS TORTUGA X 10 UNID.png",
        descripcion: "Colores: Rojo - Verde - Amarillo - Naranja - Azul - Surtido. Medidas: 18,5 cm (Diámetro). Material: Polipropileno de baja densidad.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 4999

    },

    {
        id:"fitness-11",
        producto:"DISCO BODY PUMP 5KG VACIO",
        imagen: "../statics/img/Fitness/DISCO BODY PUMP 5KG VACIO.jpeg",
        descripcion: "Disco con peso grabado, piedra, arena y metal para llegar al peso indicado. Medidas: 5,5 cm de alto x 24 cm de diametro aprox.Línea plástico super resistente.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 3999

    },

    {
        id:"fitness-12",
        producto:"ESCALERA DE COORDINACIÓN 10 ESCALONES",
        imagen: "../statics/img/Fitness/ESCALERA DE COORDINACIÓN 10 ESCALONES.jpg",
        descripcion: "Ideal para marcar el terreno y realizar trabajos coordinativos, Varilla flexible, ayuda a la coordinación y psicomotricidad. 10 escalones, 5 mts de largo X 45,5 cm de ancho. ",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 7999

    },

    {
        id:"fitness-13",
        producto:"INFLADOR DE ALUMINIO MULTIUSO",
        imagen: "../statics/img/Fitness/INFLADOR DE ALUMINIO MULTIUSO.jpg",
        descripcion: "Inflador de aluminio, con mango rebatible tipo T y pie plegables 90 grados. INCLUYE: Pico auto, pico bici común, pico para inflables y pico aguja para pelotas.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 6999

    },

    {
        id:"fitness-14",
        producto:"KIT LUCES DE BICICLETA",
        imagen: "../statics/img/Fitness/KIT LUCES DE BICICLETA.png",
        descripcion: "Luz delantera y trasera para bicicleta con dos modos de funcionamiento, fijas e intermitentes, pilas CR-2032 (tipo moneda) Incluidas, color: luz blanca y roja, material: Silicona.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 3999

    },

    {
        id:"fitness-15",
        producto:"LUZ LED BICICLETA DELANTERO RECARGABLE USB",
        imagen: "../statics/img/Fitness/LUZ LED BICICLETA DELANTERO RECARGABLE USB.jpg",
        descripcion: "Resistente a salpicaduras. Botón situado en la parte superior de la luz para un fácil acceso. Tiene 3 modos de luz: Luz Alta, Luz Baja e Intermitente. Color: Negro.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 8999

    },

    {
        id:"fitness-16",
        producto:"MOCHILA CAMPING ALPINE SKATE",
        imagen: "../statics/img/Fitness/MOCHILA CAMPING ALPINE SKATE.jpg",
        descripcion: "Medidas: 54x35x16cm. Capacidad de 45+5L, espalda y tiras acolchonadas con tela mesh, tiras regulables.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 67999

    },

    {
        id:"fitness-17",
        producto:"RIÑONERA DEPORTIVA ALPINE SKATE",
        imagen: "../statics/img/Fitness/RIÑONERA DEPORTIVA ALPINE SKATE.jpg",
        descripcion: "Incluye porta botellas. Tela mesh acolchonada para mayor comodidad COLOR: azul y negro.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 16999

    },

    {
        id:"fitness-18",
        producto:"RIÑONERA RUNNING LSYD DOBLE CIERRE",
        imagen: "../statics/img/Fitness/RIÑONERA RUNNING LSYD DOBLE CIERRE.jpg",
        descripcion: "Cierre doble, ranura para auriculares, hebilla regulable, resistente al agua. Material: neoprene. Medidas: 6 cm alto x 30 cm ancho. Color: NEGRO FUCSIA AZUL NEON.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 7999

    },

    {
        id:"fitness-19",
        producto:"TOPES MARIPOSA 28MM X 2 UNIDADES",
        imagen: "../statics/img/Fitness/TOPES MARIPOSA 25 MM X 2 UNIDADES.png",
        descripcion: "Topes de hierro simil cromado Para mancuernas y barras, resistentes al peso.",
        categoria: {
            nombre: "Fitness",
            id:"fit"
        },
        precio: 2999

    }


];
*/
function obtenerDatosDeAPI() {
    const xhr = new XMLHttpRequest();
    xhr.open('GET', 'http://127.0.0.1:5000/productos', false); // false para modo sincrónico
    xhr.send();
  
    if (xhr.status === 200) {
        const data = JSON.parse(xhr.responseText);

        // Filtrar los productos que tienen categoría "Fitness"
        const arrayDeObjetos = data
            .filter(item => item.categoria === 'fitness')
            .map(item => ({
                id: item.id,
                producto: item.producto,
                imagen: item.imagen,
                descripcion: item.descripcion,
                categoria: item.categoria,
                precio: item.precio
            }));

        return arrayDeObjetos;
    } else {
        console.error('Hubo un problema con la solicitud XMLHttpRequest:', xhr.statusText);
        return [];
    }
}

// Usar los datos obtenidos de la API
const hogarproductos = obtenerDatosDeAPI();
console.log(hogarproductos);

const contenedorProductos = document.querySelector("#contenedorProductos");
let botonCarrito = document.querySelectorAll("#boton-carrito");
const numero = document.querySelector("#numero");   

function cargarProductos(){

    hogarproductos.forEach(hogarproducto => {

        const div = document.createElement("div");
        div.classList.add("hogar-items");
        div.innerHTML = `   
        <img  class="img-hogar"  src="${hogarproducto.imagen}" alt="${hogarproducto.producto}">
        <h3 class="producto">${hogarproducto.producto}</h3>
        <p  class="descripcion">${hogarproducto.descripcion}</p>
        <h5 class="precio">$${hogarproducto.precio}</h5>
        <button class="boton-carrito" id="${hogarproducto.id}">Agregar </button>
        
        `
        ;
        contenedorProductos.append(div);

    })

    actualizarBotonesCarrito();

} ;
cargarProductos();

function actualizarBotonesCarrito(){
    botonCarrito = document.querySelectorAll(".boton-carrito");

    botonCarrito.forEach(boton => {
        boton.addEventListener("click",agregarAlCarrito);

    })

};
let productosEnCarrito;

let productosEnCarritoLS = localStorage.getItem("productos-en-carrito");

if (productosEnCarritoLS) {
    productosEnCarrito = JSON.parse(productosEnCarritoLS);
    actualizarNumero();
} else{
    productosEnCarrito = [];
}

function agregarAlCarrito(e){

    const idBoton = Number(e.currentTarget.id);
    const productoAgregado = hogarproductos.find(producto => producto.id === idBoton);

    if(productosEnCarrito.some(producto => producto.id === idBoton)){
        const index =    productosEnCarrito.findIndex(producto => producto.id ===idBoton);
        productosEnCarrito[index].cantidad++;
    
    } else{
        productoAgregado.cantidad = 1;
        productosEnCarrito.push(productoAgregado);
        
    }

    actualizarNumero();

    localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito));
}
function actualizarNumero() {
    let numeroJS = productosEnCarrito.reduce((acc, producto) => acc + producto.cantidad,0);
    numero.innerHTML = numeroJS;

}




