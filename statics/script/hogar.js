/*
const hogarproductos = [
    {
        id:"hogar-01",
        producto:"ALMOHADONES INFANTILES",
        imagen: "../statics/img/Hogar/almohadones-infantiles.jpg",
        descripcion: "Para usar en casa o para llevar a todos lados, Tamaño 40x40cm, Material de excelente calidad.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 4200

    },

    {
        id:"hogar-02",
        producto:"BATIDOR ESPUMADOR",
        imagen: "../statics/img/Hogar/batidor.jpg",
        descripcion: "Material: Plástico reforzado Para hacer el mejor capuchino, omelette, milk shake, etc.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 2999

    },

    {
        id:"hogar-03",
        producto:"BIDON TERMICO 2L CON PICO VERTEDOR",
        imagen: "../statics/img/Hogar/bidon.jpg",
        descripcion: "Único con tapa para grande para poner hielo y limpiar.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 4999

    },

    {
        id:"hogar-04",
        producto:"BOMBILLA INOXIDABLE RESORTE REGULABLE",
        imagen: "../statics/img/Hogar/bombilla.jpg",
        descripcion: "Bombilla inoxidable, no se tapa, no se oxida, fácil de limpiar. Resorte inoxidable regulable.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 3299

    }
   
    ,

    {
        id:"hogar-05",
        producto:"BOMBILLA PERITA COCO PLANA ANGOSTA X 5",
        imagen: "../statics/img/Hogar/BOMBILLA PERITA COCO PLANA ANGOSTA X 5.jpeg",
        descripcion: "Bombillas de Acero inoxidable planas. Metamate premium. Largo: 17 cm Color: Único.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 9999

    }

    ,

    {
        id:"hogar-06",
        producto:"BOTELLA SPORT 500 ML",
        imagen: "../statics/img/Hogar/botella_sport.jpg",
        descripcion: "Fabricada en Acero inoxidable Doble Capa de Altísima calidad.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 16999

    }

    ,

    {
        id:"hogar-07",
        producto:"CALCULADORA",
        imagen: "../statics/img/Hogar/calculadora.jpg",
        descripcion: "Calculadoara con Visor LCD de 12 dígitos grandes, cálculo rápido de Costo/ Margen/ Precio de Venta, selector de Redondeo y de Punto decimal, Cálculo de Impuesto con tasa programable, 4 memorias de cálculo.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 6999

    }

    ,

    {
        id:"hogar-08",
        producto:"DELANTAL MANOPLA Y AGARRADERA ",
        imagen: "../statics/img/Hogar/delantal.jpeg",
        descripcion: "MEDIDAS: DELANTAL DE 75CM X 50CM, MANOPLA 26CM APROX Y AGARRADERA DE 18CM APROX",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 14999

    }   

    ,

    {
        id:"hogar-09",
        producto:"GUANTES DE SILICONA",
        imagen: "../statics/img/Hogar/guantes.jpeg",
        descripcion: "Gran elasticidad y resistencia al calor: -60 °C a 230 °C. Talle: Universal. Medidas: 31,5cm de largo X 13cm de ancho. Peso: 170 g (el par). COLOR: AZUL, ROSA Y VERDE.  ",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 8999

    }   

    ,

    {
        id:"hogar-10",
        producto:"JARRA FAMILIAR 5 LITROS 4 VASOS",
        imagen: "../statics/img/Hogar/jarra familiar.jpg",
        descripcion: "Linda y cómoda jarra familiar con 4 vasos plásticos, libres de BPA. Cuadrada, de 25 cm de alto x 16,5 cm de ancho.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 7999

    }   

    ,

    {
        id:"hogar-11",
        producto:"JARRO MATE LISTO ALUMINIO",
        imagen: "../statics/img/Hogar/JARRO MATE LISTO ALUMINIO.jpeg",
        descripcion: "Características: Mate autocebante de plástico polipropileno, con base aluminio, cuenta con bombilla de bronce niquelado incorporada. Colores: Verde, azul, rojo, rosa y lila",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 7999

    }   

    ,

    {
        id:"hogar-12",
        producto:"JUEGO DE SABANAS BORDADAS SUPER KING",
        imagen: "../statics/img/Hogar/sabanas.jpg",
        descripcion: "BORDADO SOLO EN LA FUNDA DE LA ALMOHADA Juego de sabanas 100% ALGODON de 4 piezas, Calidad premium.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 48999

    }   

    ,

    {
        id:"hogar-13",
        producto:"JUEGO DE SABANAS ESTAMPADAS KING",
        imagen: "../statics/img/Hogar/JUEGO DE SABANAS ESTAMPADAS KING.jpg",
        descripcion: "Juego de sabanas de 4 piezas, Calidad premium, Atemporal con atractivo elegante. Composición 70% algodón y 30% microfibra.",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 38999

    }   

    ,

    {
        id:"hogar-14",
        producto:"LÁMPARA LED MATAMOSQUITOS",
        imagen: "../statics/img/Hogar/LAMPARA-led.jpg",
        descripcion: "Lámpara Foco Led BAJO CONSUMO y Mata Moscas Mosquitos Insectos, practica y fácil de instalar,",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 7999

    }   

    ,

    {
        id:"hogar-15",
        producto:"MATE TERMICO CON BOMBILLA 236 ML",
        imagen: "../statics/img/Hogar/MATE TERMICO CON BOMBILLA 236 ML.jpg",
        descripcion: "Mate doble pared de acero Inoxidable. Bombilla de acero inoxidable. Apto Frio calor. Ideal para Terere y Mate. ",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 20999

    }   

    ,

    {
        id:"hogar-16",
        producto:"TERMO MEDIA MANIJA 1 LITRO",
        imagen: "../statics/img/Hogar/TERMO MEDIA MANIJA.jpg",
        descripcion: "Modelo ergonómico, ligero e irrompible. Tapa resistente con rosca antiderrame: para usar como vaso, taza o mate. 100% hermético. Conservación de líquidos hasta por 12hs aproximadamente. ",
        categoria: {
            nombre: "Hogar",
            id:"hogares"
        },
        precio: 20999

    }   

];
*/

function obtenerDatosDeAPI() {
    const xhr = new XMLHttpRequest();
    xhr.open('GET', 'http://127.0.0.1:5000/productos', false); // false para modo sincrónico
    xhr.send();
  
    if (xhr.status === 200) {
        const data = JSON.parse(xhr.responseText);

        // Filtrar los productos que tienen categoría "Hogar"
        const arrayDeObjetos = data
            .filter(item => item.categoria === 'hogar')
            .map(item => ({
                id: item.id,
                producto: item.producto,
                imagen: item.imagen,
                descripcion: item.descripcion,
                categoria: item.categoria,
                precio: item.precio
            }));

        return arrayDeObjetos;
    } else {
        console.error('Hubo un problema con la solicitud XMLHttpRequest:', xhr.statusText);
        return [];
    }
}

// Usar los datos obtenidos de la API
const hogarproductos = obtenerDatosDeAPI();
console.log(hogarproductos);
  

const contenedorProductos = document.querySelector("#contenedorProductos");
let botonCarrito = document.querySelectorAll("#boton-carrito");
const numero = document.querySelector("#numero");   

function cargarProductos(){

    hogarproductos.forEach(hogarproducto => {

        const div = document.createElement("div");
        div.classList.add("hogar-items");
        div.innerHTML = `   
        <img  class="img-hogar"  src="${hogarproducto.imagen}" alt="${hogarproducto.producto}">
        <h3 class="producto">${hogarproducto.producto}</h3>
        <p  class="descripcion">${hogarproducto.descripcion}</p>
        <h5 class="precio">$${hogarproducto.precio}</h5>
        <button class="boton-carrito" id="${hogarproducto.id}">Agregar </button>
        
        `
        ;
        contenedorProductos.append(div);

    })

    actualizarBotonesCarrito();

} ;
cargarProductos();

function actualizarBotonesCarrito(){
    botonCarrito = document.querySelectorAll(".boton-carrito");

    botonCarrito.forEach(boton => {
        boton.addEventListener("click",agregarAlCarrito);

    })

};
let productosEnCarrito;

let productosEnCarritoLS = localStorage.getItem("productos-en-carrito");

if (productosEnCarritoLS) {
    productosEnCarrito = JSON.parse(productosEnCarritoLS);
    actualizarNumero();
} else{
    productosEnCarrito = [];
}

function agregarAlCarrito(e){

    const idBoton = Number(e.currentTarget.id);
    const productoAgregado = hogarproductos.find(producto => producto.id === idBoton);

    if(productosEnCarrito.some(producto => producto.id === idBoton)){
        const index =    productosEnCarrito.findIndex(producto => producto.id ===idBoton);
        productosEnCarrito[index].cantidad++;
    
    } else{
        productoAgregado.cantidad = 1;
        productosEnCarrito.push(productoAgregado);
        
    }

    actualizarNumero();

    localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito));
}
function actualizarNumero() {
    let numeroJS = productosEnCarrito.reduce((acc, producto) => acc + producto.cantidad,0);
    numero.innerHTML = numeroJS;

}




